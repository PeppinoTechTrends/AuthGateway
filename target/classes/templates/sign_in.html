<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link type="text/css" rel="stylesheet" href="/static/assets/css/style-mobile-sign-in.css" media="screen and (max-width: 750px)">
    <link type="text/css" rel="stylesheet" href="/static/assets/css/style-sign-in.css" media="screen and (min-width: 751px)">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

</head>
<link rel="icon" type="image/png" href="/static/assets/img/mcdonalds-favicon.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

<title>MCDonald's - Pagina di accesso</title>
</head>
<body>

<div class="All-Content">

    <div class="header-side-login-content">
        <img src="/static/assets/img/header-maionese.png" alt="Header Image">
    </div>

    <div class="left-side-login-content">
        <a href="index.html" id="mc_logo_link" target="_blank"><img id="mc_logo_img" src="/static/assets/img/mc-donalds-logo..png" alt=""></a>
        <a href="https://www.mcdonalds.it/prodotti/menu" id="menu_link" target="_blank"><img id="menu_img" src="/static/assets/img/menu.png" alt=""></a>
        <img id="icecream_img" src="/static/assets/img/icecream.png" alt="">
        <img id="cola_img" src="/static/assets/img/cola.png" alt="">
        <h1 class="principal-text" style="padding-left: 3px; position: relative; bottom: 4vw;">Benvenuto nel mondo del sapore autentico. <br> Preparati a vivere un'esperienza unica e gustosa!</h1>
        <h2 class="link-text" style="position: relative; bottom: 4%;"><a href="https://www.mcdonalds.it/prodotti/menu" target="_blank">Consulta i nostri ricchi menu'</a></h2>
    </div>

    <div class="right-side-login-content">
        <img id="happy_meal" src="/static/assets/img/happy_.png" alt="">
        <h1 id="accesso_utente" class="principal-text">Accesso UTENTE</h1>

        <div class="login-content">
            <img id="milkshake" src="/static/assets/img/milkshake.png" alt="">
            <img id="nuggets" src="/static/assets/img/nuggets.png" alt="">
            <form th:action="@{/sign_in}" method="post">
                <label for="uname"><b>Nome Utente</b></label><br>
                <input type="text" placeholder="Inserisci il nome utente" name="uname" maxlength="15" minlength="6" required><br>

                <label for="psw"><b>Chiave di Accesso</b></label><br>
                <div class="password-container">
                    <input type="password" id="password" placeholder="Inserisci la chiave di accesso" name="psw" maxlength="15" minlength="6" required>
                    <span class="password-toggle" id="togglePassword"></span>
                    <i id="hamburger_pass" title="Mostra la chiave di accesso!" class="fa-solid fa-burger" onmousedown="togglePasswordVisibility(true)" onmouseup="togglePasswordVisibility(false)" onmouseleave="togglePasswordVisibility(false)" ></i>
                    </span>
                </div><br>
R
                <div style="position: relative; bottom: 3vw; right: 1vw;" class="password-options">
                    <span style="position: relative; bottom: 1vw; font-size: calc(0.7em + 0.3vw); left: 1.3vw;">Hai dimenticato la <a href="passw_forgot">password?</a></span><br>
                    <input style="margin-top: 3vw;" type="checkbox" checked="checked" name="remember"> Ricorda accesso
                </div>

                <button style="position: relative; bottom: 3vw;" type="submit">Accedi</button>
                <p style="text-align: center; margin-top: -2vw; font-size: calc(0.7em + 0.3vw);">Non sei ancora registrato? <a id="sign_up" style="color: #FFC72C;" href="sign_up">Registrati qui</a></p>
            </form>
        </div>


    </div>

    <div class="footer-side-login-content">
        <img src="/static/assets/img/header-ketchup.png" alt="Header Image">
    </div>
</div>


<script>
    function correctLogin() {
        // Utilizza SweetAlert2 per mostrare un avviso personalizzato
        Swal.fire({
            title: 'Accesso Confermato',
            text: 'Login eseguito con successo! Benvenuto, ' + data.username + '!',
            icon: 'success', // Cambia l'icona a seconda delle tue esigenze
            confirmButtonText: 'OK',
            allowOutsideClick: false // L'utente non può chiudere l'avviso cliccando al di fuori di esso
        }).then((result) => {
            // Dopo che l'utente ha cliccato su "OK", reindirizza alla pagina principale solo se ha premuto "OK"
            if (result.isConfirmed) {
                window.location.href = "www.google.com";
            }
        });
    }

    function wrongLogin() {
        Swal.fire({
            title: 'Accesso Negato',
            text: 'Credenziali Errate, Riprova!',
            icon: 'error', // Cambia l'icona a seconda delle tue esigenze
            confirmButtonText: 'OK',
            allowOutsideClick: false // L'utente non può chiudere l'avviso cliccando al di fuori di esso
        });

    }

    function cantLogin() {
        Swal.fire({
            title: 'Accesso Negato',
            text: 'Si è verificato un errore durante il login. Riprova piu tardi!',
            icon: 'error', // Cambia l'icona a seconda delle tue esigenze
            confirmButtonText: 'OK',
            allowOutsideClick: false // L'utente non può chiudere l'avviso cliccando al di fuori di esso
        });
    }

    function handleLogin() {
        const form = document.querySelector('form');

        form.addEventListener('submit', function (event) {
            event.preventDefault();

            const username = document.querySelector('input[name=uname]').value;
            const password = document.querySelector('input[name=psw]').value;

            // Simula una richiesta al backend (ipotetico) in Java
            fetch('/api/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    username: username,
                    password: password
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Credenziali corrette, mostra l'alert di login eseguito
                    correctLogin();
                } else {
                    // Credenziali errate, mostra un messaggio di errore
                    wrongLogin();
                }
            })
            .catch(error => {
                console.error('Errore durante la richiesta al backend:', error);
                cantLogin();
            });
        });
    }

    let isHamburgerClicked = false;

    function togglePasswordVisibility(mouseDown) {
        const passwordInput = document.getElementById("password");
        const hamburgerIcon = document.getElementById("hamburger_pass");

        if (mouseDown) {
            isHamburgerClicked = true;
            passwordInput.type = "text";
            hamburgerIcon.style.opacity = 0.5;
        } else {
            isHamburgerClicked = false;
            passwordInput.type = "password";
            hamburgerIcon.style.opacity = 1;
        }
    }

</script>


</body>


</html>